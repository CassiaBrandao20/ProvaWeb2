{"ast":null,"code":"var _jsxFileName = \"E:\\\\PROJETOS\\\\GIT\\\\SISTEMA DE ATIVIDADE\\\\client\\\\src\\\\pages\\\\login\\\\Login.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport * as Yup from 'yup';\nimport { useNavigate } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { hash } from 'bcryptjs';\nimport './Login.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst loginSchema = Yup.object().shape({\n  usuario: Yup.string().required('O campo usuário é obrigatório'),\n  senha: Yup.string().required('O campo senha é obrigatório')\n});\nconst Login = _ref => {\n  _s();\n  let {\n    setAuthenticated\n  } = _ref;\n  const [usuario, setUsuario] = useState('');\n  const [senha, setSenha] = useState('');\n  const [erro, setErro] = useState('');\n  const navigate = useNavigate();\n  const handleLogin = async e => {\n    e.preventDefault();\n    try {\n      // Validar campos usando Yup\n      await loginSchema.validate({\n        usuario,\n        senha\n      }, {\n        abortEarly: false\n      });\n\n      // Comparar a senha com bcrypt\n      const hashedPassword = await hash(senha, 10);\n      if (!passwordMatch) {\n        // Senha inválida\n        setErro('Senha inválida');\n        return;\n      }\n      const response = await axios.post('http://localhost:4003/login', {\n        usuario,\n        senha: passwordMatch\n      });\n      if (response.status === 200) {\n        const {\n          success\n        } = response.data;\n        if (success) {\n          setErro('');\n          setAuthenticated(true); // Definir autenticação como verdadeira\n          navigate('/home'); // Redirecionar para a rota \"/home\"\n        } else {\n          // Exibir mensagem de erro\n          const {\n            message\n          } = response.data;\n          setErro(message);\n        }\n      } else {\n        // Exibir mensagem de erro genérica\n        setErro('Senha ou usuário inválido');\n      }\n    } catch (error) {\n      if (error instanceof Yup.ValidationError) {\n        // Erros de validação do Yup\n        const validationErrors = {};\n        error.inner.forEach(err => {\n          validationErrors[err.path] = err.message;\n        });\n        setErro(validationErrors);\n      } else {\n        // Erro genérico\n        console.error(error);\n        setErro('Ocorreu um erro durante o login');\n      }\n    }\n  };\n  const handleChangeUsuario = e => {\n    setUsuario(e.target.value);\n  };\n  const handleChangeSenha = e => {\n    setSenha(e.target.value);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Tela de Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleLogin,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"usuario\",\n          children: \"Usu\\xE1rio:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"usuario\",\n          value: usuario,\n          onChange: handleChangeUsuario\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), erro.usuario && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: erro.usuario\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 28\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"senha\",\n          children: \"Senha:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"senha\",\n          value: senha,\n          onChange: handleChangeSenha\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this), erro.senha && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: erro.senha\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 26\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), erro && !erro.usuario && !erro.senha && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error-message\",\n        children: erro\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Entrar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Se voc\\xEA ainda n\\xE3o possui uma conta, contate o administrador.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"CTNb71byxw3VVI7L0Tl3nzJDKmc=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nLogin.propTypes = {\n  setAuthenticated: PropTypes.func.isRequired\n};\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","axios","Yup","useNavigate","PropTypes","hash","jsxDEV","_jsxDEV","loginSchema","object","shape","usuario","string","required","senha","Login","_ref","_s","setAuthenticated","setUsuario","setSenha","erro","setErro","navigate","handleLogin","e","preventDefault","validate","abortEarly","hashedPassword","passwordMatch","response","post","status","success","data","message","error","ValidationError","validationErrors","inner","forEach","err","path","console","handleChangeUsuario","target","value","handleChangeSenha","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","type","id","onChange","_c","propTypes","func","isRequired","$RefreshReg$"],"sources":["E:/PROJETOS/GIT/SISTEMA DE ATIVIDADE/client/src/pages/login/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport * as Yup from 'yup';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport PropTypes from 'prop-types';\r\nimport { hash } from 'bcryptjs';\r\n\r\nimport './Login.css';\r\n\r\nconst loginSchema = Yup.object().shape({\r\n  usuario: Yup.string().required('O campo usuário é obrigatório'),\r\n  senha: Yup.string().required('O campo senha é obrigatório'),\r\n});\r\n\r\nconst Login = ({ setAuthenticated }) => {\r\n  const [usuario, setUsuario] = useState('');\r\n  const [senha, setSenha] = useState('');\r\n  const [erro, setErro] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      // Validar campos usando Yup\r\n      await loginSchema.validate({ usuario, senha }, { abortEarly: false });\r\n\r\n      // Comparar a senha com bcrypt\r\n      const hashedPassword = await hash(senha, 10);\r\n\r\n      if (!passwordMatch) {\r\n        // Senha inválida\r\n        setErro('Senha inválida');\r\n        return;\r\n      }\r\n\r\n      const response = await axios.post('http://localhost:4003/login', {\r\n        usuario,\r\n        senha : passwordMatch,\r\n      });\r\n\r\n      if (response.status === 200) {\r\n        const { success } = response.data;\r\n        if (success) {\r\n          setErro('');\r\n          setAuthenticated(true); // Definir autenticação como verdadeira\r\n          navigate('/home'); // Redirecionar para a rota \"/home\"\r\n        } else {\r\n          // Exibir mensagem de erro\r\n          const { message } = response.data;\r\n          setErro(message);\r\n        }\r\n      } else {\r\n        // Exibir mensagem de erro genérica\r\n        setErro('Senha ou usuário inválido');\r\n      }\r\n    } catch (error) {\r\n      if (error instanceof Yup.ValidationError) {\r\n        // Erros de validação do Yup\r\n        const validationErrors = {};\r\n        error.inner.forEach((err) => {\r\n          validationErrors[err.path] = err.message;\r\n        });\r\n        setErro(validationErrors);\r\n      } else {\r\n        // Erro genérico\r\n        console.error(error);\r\n        setErro('Ocorreu um erro durante o login');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleChangeUsuario = (e) => {\r\n    setUsuario(e.target.value);\r\n  };\r\n\r\n  const handleChangeSenha = (e) => {\r\n    setSenha(e.target.value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <h2>Tela de Login</h2>\r\n      <form onSubmit={handleLogin}>\r\n        <div>\r\n          <label htmlFor=\"usuario\">Usuário:</label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"usuario\"\r\n            value={usuario}\r\n            onChange={handleChangeUsuario}\r\n          />\r\n          {erro.usuario && <p className=\"error-message\">{erro.usuario}</p>}\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"senha\">Senha:</label>\r\n          <input\r\n            type=\"password\"\r\n            id=\"senha\"\r\n            value={senha}\r\n            onChange={handleChangeSenha}\r\n          />\r\n          {erro.senha && <p className=\"error-message\">{erro.senha}</p>}\r\n        </div>\r\n        {erro && !erro.usuario && !erro.senha && (\r\n          <p className=\"error-message\">{erro}</p>\r\n        )}\r\n        <button type=\"submit\">Entrar</button>\r\n      </form>\r\n      <p>\r\n        Se você ainda não possui uma conta, contate o administrador.\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nLogin.propTypes = {\r\n  setAuthenticated: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,KAAKC,GAAG,MAAM,KAAK;AAC1B,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,SAAS,MAAM,YAAY;AAClC,SAASC,IAAI,QAAQ,UAAU;AAE/B,OAAO,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErB,MAAMC,WAAW,GAAGN,GAAG,CAACO,MAAM,CAAC,CAAC,CAACC,KAAK,CAAC;EACrCC,OAAO,EAAET,GAAG,CAACU,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,+BAA+B,CAAC;EAC/DC,KAAK,EAAEZ,GAAG,CAACU,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,6BAA6B;AAC5D,CAAC,CAAC;AAEF,MAAME,KAAK,GAAGC,IAAA,IAA0B;EAAAC,EAAA;EAAA,IAAzB;IAAEC;EAAiB,CAAC,GAAAF,IAAA;EACjC,MAAM,CAACL,OAAO,EAAEQ,UAAU,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACc,KAAK,EAAEM,QAAQ,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACqB,IAAI,EAAEC,OAAO,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAMuB,QAAQ,GAAGpB,WAAW,CAAC,CAAC;EAE9B,MAAMqB,WAAW,GAAG,MAAOC,CAAC,IAAK;IAC/BA,CAAC,CAACC,cAAc,CAAC,CAAC;IAElB,IAAI;MACF;MACA,MAAMlB,WAAW,CAACmB,QAAQ,CAAC;QAAEhB,OAAO;QAAEG;MAAM,CAAC,EAAE;QAAEc,UAAU,EAAE;MAAM,CAAC,CAAC;;MAErE;MACA,MAAMC,cAAc,GAAG,MAAMxB,IAAI,CAACS,KAAK,EAAE,EAAE,CAAC;MAE5C,IAAI,CAACgB,aAAa,EAAE;QAClB;QACAR,OAAO,CAAC,gBAAgB,CAAC;QACzB;MACF;MAEA,MAAMS,QAAQ,GAAG,MAAM9B,KAAK,CAAC+B,IAAI,CAAC,6BAA6B,EAAE;QAC/DrB,OAAO;QACPG,KAAK,EAAGgB;MACV,CAAC,CAAC;MAEF,IAAIC,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;QAC3B,MAAM;UAAEC;QAAQ,CAAC,GAAGH,QAAQ,CAACI,IAAI;QACjC,IAAID,OAAO,EAAE;UACXZ,OAAO,CAAC,EAAE,CAAC;UACXJ,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;UACxBK,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;QACrB,CAAC,MAAM;UACL;UACA,MAAM;YAAEa;UAAQ,CAAC,GAAGL,QAAQ,CAACI,IAAI;UACjCb,OAAO,CAACc,OAAO,CAAC;QAClB;MACF,CAAC,MAAM;QACL;QACAd,OAAO,CAAC,2BAA2B,CAAC;MACtC;IACF,CAAC,CAAC,OAAOe,KAAK,EAAE;MACd,IAAIA,KAAK,YAAYnC,GAAG,CAACoC,eAAe,EAAE;QACxC;QACA,MAAMC,gBAAgB,GAAG,CAAC,CAAC;QAC3BF,KAAK,CAACG,KAAK,CAACC,OAAO,CAAEC,GAAG,IAAK;UAC3BH,gBAAgB,CAACG,GAAG,CAACC,IAAI,CAAC,GAAGD,GAAG,CAACN,OAAO;QAC1C,CAAC,CAAC;QACFd,OAAO,CAACiB,gBAAgB,CAAC;MAC3B,CAAC,MAAM;QACL;QACAK,OAAO,CAACP,KAAK,CAACA,KAAK,CAAC;QACpBf,OAAO,CAAC,iCAAiC,CAAC;MAC5C;IACF;EACF,CAAC;EAED,MAAMuB,mBAAmB,GAAIpB,CAAC,IAAK;IACjCN,UAAU,CAACM,CAAC,CAACqB,MAAM,CAACC,KAAK,CAAC;EAC5B,CAAC;EAED,MAAMC,iBAAiB,GAAIvB,CAAC,IAAK;IAC/BL,QAAQ,CAACK,CAAC,CAACqB,MAAM,CAACC,KAAK,CAAC;EAC1B,CAAC;EAED,oBACExC,OAAA;IAAK0C,SAAS,EAAC,OAAO;IAAAC,QAAA,gBACpB3C,OAAA;MAAA2C,QAAA,EAAI;IAAa;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACtB/C,OAAA;MAAMgD,QAAQ,EAAE/B,WAAY;MAAA0B,QAAA,gBAC1B3C,OAAA;QAAA2C,QAAA,gBACE3C,OAAA;UAAOiD,OAAO,EAAC,SAAS;UAAAN,QAAA,EAAC;QAAQ;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACzC/C,OAAA;UACEkD,IAAI,EAAC,MAAM;UACXC,EAAE,EAAC,SAAS;UACZX,KAAK,EAAEpC,OAAQ;UACfgD,QAAQ,EAAEd;QAAoB;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC,EACDjC,IAAI,CAACV,OAAO,iBAAIJ,OAAA;UAAG0C,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAE7B,IAAI,CAACV;QAAO;UAAAwC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7D,CAAC,eACN/C,OAAA;QAAA2C,QAAA,gBACE3C,OAAA;UAAOiD,OAAO,EAAC,OAAO;UAAAN,QAAA,EAAC;QAAM;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACrC/C,OAAA;UACEkD,IAAI,EAAC,UAAU;UACfC,EAAE,EAAC,OAAO;UACVX,KAAK,EAAEjC,KAAM;UACb6C,QAAQ,EAAEX;QAAkB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7B,CAAC,EACDjC,IAAI,CAACP,KAAK,iBAAIP,OAAA;UAAG0C,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAE7B,IAAI,CAACP;QAAK;UAAAqC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzD,CAAC,EACLjC,IAAI,IAAI,CAACA,IAAI,CAACV,OAAO,IAAI,CAACU,IAAI,CAACP,KAAK,iBACnCP,OAAA;QAAG0C,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAE7B;MAAI;QAAA8B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CACvC,eACD/C,OAAA;QAAQkD,IAAI,EAAC,QAAQ;QAAAP,QAAA,EAAC;MAAM;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjC,CAAC,eACP/C,OAAA;MAAA2C,QAAA,EAAG;IAEH;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEV,CAAC;AAACrC,EAAA,CApGIF,KAAK;EAAA,QAIQZ,WAAW;AAAA;AAAAyD,EAAA,GAJxB7C,KAAK;AAsGXA,KAAK,CAAC8C,SAAS,GAAG;EAChB3C,gBAAgB,EAAEd,SAAS,CAAC0D,IAAI,CAACC;AACnC,CAAC;AAED,eAAehD,KAAK;AAAC,IAAA6C,EAAA;AAAAI,YAAA,CAAAJ,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}